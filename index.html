<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0f1419">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Card Counter Pro">
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkNhcmQgQ291bnRlciBQcm8iLAogICJzaG9ydF9uYW1lIjogIkNhcmQgUHJvIiwKICAiZGVzY3JpcHRpb24iOiAiTWFzdGVyIGNhcmQgY291bnRpbmcgYW5kIGJsYWNramFjayBzdHJhdGVneSIsCiAgInN0YXJ0X3VybCI6ICIuLyIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzBmMTQxOSIsCiAgInRoZW1lX2NvbG9yIjogIiMwZjE0MTkiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSFpwWlhkQ2IzZzlJakFnTUNBMU1USWdOVEV5SWo0OGNtVmpkQ0IzYVdSMGFEMGlOVEV5SWlCb1pXbG5hSFE5SWpVeE1pSWdabWxzYkQwaUl6Qm1NVFF4T1NJdlBqeDBaWGgwSUhnOUlqSTFOaUlnZVQwaU1qVTJJaUIwWlhoMExXRnVZMmh2Y2owaWJXbGtaR3hsSWlCbWIyNTBMV1poYldsc2VUMGljMkZ1Y3kxelpYSnBaaUlnWm1sc2JEMGlJekF3Wm1ZNE9DSWdabTl1ZEMxemFYcGxQU0l4TWpBaVBsYzhMM1JsZUhRK1BDOXpkbWMrIiwKICAgICAgInNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfSwKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSFpwWlhkQ2IzZzlJakFnTUNBeE9UQWdNVGt3SWo0OGNtVmpkQ0IzYVdSMGFEMGlNVGt3SWlCb1pXbG5hSFE5SWpFNU1DSWdabWxzYkQwaUl6Qm1NVFF4T1NJdlBqeDBaWGgwSUhnOUlqazFJaUI1UFNJNU5TSWdkR1Y0ZEMxaGJtTm9iM0k5SW0xcFpHUnNaU0lnWm05dWRDMW1ZVzFwYkhrOUluTmhibk10YzJWeWFXWWlJR1pwYkd3OUlpTXdNR1ptT0RnaUlHWm9iZDB6TGpFNU9TQXRZM0pwWjJoME9pQW5OREF3SnpvaUlHWnZiblF0YzJsNlpUMGlOREJOWldScGRXMGlQakpXUEM5MFpYaDBQand2YzNablBnPT0iLAogICAgICAic2l6ZXMiOiAiMTkyeDE5MiIsCiAgICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9CiAgXQp9">
    <title>Blackjack Pro Trainer - Master the Count & Blackjack</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Poppins:wght@300;400;600;700&family=Courier+Prime:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --bg-dark: #0f1419;
            --bg-card: #1a1f2e;
            --bg-surface: #252b3b;
            --text-primary: #ffffff;
            --text-secondary: #8b92a8;
            --accent-green: #00ff88;
            --accent-red: #ff4757;
            --accent-gold: #ffd700;
            --accent-blue: #00d4ff;
            --shadow: rgba(0, 0, 0, 0.5);
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0f1419 0%, #1a1f2e 100%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 255, 136, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 212, 255, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }
        
        .container {
            position: relative;
            z-index: 1;
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Landing Page */
        .landing {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .landing h1 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 6rem;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            letter-spacing: 3px;
            animation: glow 2s ease-in-out infinite;
        }
        
        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 20px rgba(0, 255, 136, 0.3)); }
            50% { filter: drop-shadow(0 0 40px rgba(0, 255, 136, 0.6)); }
        }
        
        .landing .subtitle {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 3rem;
            font-weight: 300;
        }
        
        .mode-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 2rem;
            margin-bottom: 3rem;
            max-width: 900px;
        }
        
        .mode-card {
            background: var(--bg-card);
            border: 3px solid transparent;
            border-radius: 20px;
            padding: 3rem 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .mode-card:hover {
            border-color: var(--accent-green);
            transform: translateY(-10px);
            box-shadow: 0 20px 60px rgba(0, 255, 136, 0.3);
        }
        
        .mode-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
        }
        
        .mode-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
        }
        
        .mode-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 1rem;
            letter-spacing: 2px;
        }
        
        .mode-desc {
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.6;
        }
        
        .card-preview {
            display: flex;
            gap: 1rem;
            margin-bottom: 3rem;
            perspective: 1000px;
        }
        
        .preview-card {
            width: 100px;
            height: 140px;
            background: var(--bg-card);
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            animation: float 3s ease-in-out infinite;
            box-shadow: 0 10px 30px var(--shadow);
        }
        
        .preview-card:nth-child(1) { animation-delay: 0s; }
        .preview-card:nth-child(2) { animation-delay: 0.2s; }
        .preview-card:nth-child(3) { animation-delay: 0.4s; }
        .preview-card:nth-child(4) { animation-delay: 0.6s; }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotateY(0deg); }
            50% { transform: translateY(-20px) rotateY(10deg); }
        }
        
        .time-options {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            justify-content: center;
        }
        
        .time-btn {
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            background: var(--bg-surface);
            color: var(--text-primary);
        }
        
        .time-btn:hover {
            border-color: var(--accent-green);
            transform: translateY(-2px);
        }
        
        .time-btn.selected {
            border-color: var(--accent-green);
            background: rgba(0, 255, 136, 0.1);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }
        
        .btn {
            padding: 1.25rem 3rem;
            font-size: 1.2rem;
            font-weight: 600;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            color: var(--bg-dark);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0, 255, 136, 0.5);
        }
        
        .btn-secondary {
            background: var(--bg-surface);
            color: var(--text-primary);
            border: 2px solid rgba(255, 255, 255, 0.2);
            margin-left: 1rem;
        }
        
        .btn-secondary:hover {
            border-color: var(--accent-green);
            transform: translateY(-3px);
        }
        
        /* Card Skin Selector - condensed for space */
        .skin-selector {
            margin-top: 2rem;
            padding: 2rem;
            background: var(--bg-card);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            max-width: 800px;
        }
        
        .skin-selector h3 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            letter-spacing: 2px;
        }
        
        .skin-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 1rem;
        }
        
        .skin-option {
            padding: 1rem;
            background: var(--bg-surface);
            border: 3px solid transparent;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-height: 100px;
        }
        
        .skin-option:hover {
            border-color: var(--accent-green);
            transform: translateY(-5px);
        }
        
        .skin-option.selected {
            border-color: var(--accent-green);
            background: rgba(0, 255, 136, 0.1);
        }
        
        .skin-preview-mini {
            width: 50px;
            height: 70px;
            border-radius: 6px;
            margin: 0 auto 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .preview-classic {
            background: linear-gradient(135deg, #ffffff 0%, #f0f0f0 100%);
            border: 2px solid #ddd;
            color: #e74c3c;
        }
        
        .skin-name {
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        /* Game Page */
        .game-page {
            min-height: 100vh;
            padding-top: 2rem;
        
                height: 100vh;
                overflow: hidden;}
        
        .game-header {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 2rem;
            gap: 2rem;
            flex-wrap: wrap;
        }
        
        .stat-box {
            background: var(--bg-card);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 1.5rem 2rem;
            min-width: 180px;
            position: relative;
            overflow: hidden;
        }
        
        .stat-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            font-family: 'Bebas Neue', sans-serif;
            letter-spacing: 2px;
        }
        
        .timer { color: var(--accent-blue); }
        .timer.warning { color: var(--accent-gold); animation: pulse 0.5s ease-in-out infinite; }
        .timer.critical { color: var(--accent-red); animation: pulse 0.3s ease-in-out infinite; }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .cards-seen { color: var(--accent-gold); }
        
        /* Card Display */
        .card-area {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 350px;
            margin-bottom: 2rem;
            perspective: 1500px;
        }
        
        .playing-card {
            width: 200px;
            height: 280px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.15s ease-out;
            cursor: pointer;
        }
        
        .playing-card.flipping {
            animation: quickFlip 0.15s ease-out;
        }
        
        @keyframes quickFlip {
            0% { transform: rotateY(0deg) scale(1); }
            50% { transform: rotateY(90deg) scale(0.95); }
            100% { transform: rotateY(0deg) scale(1); }
        }
        
        .card-face {
            width: 100%;
            height: 100%;
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        /* Classic Skin */
        .skin-classic .card-face {
            background: linear-gradient(135deg, #ffffff 0%, #f5f5f5 100%);
            border: 3px solid #e0e0e0;
        }
        
        .card-rank {
            font-size: 6rem;
            font-weight: 700;
            line-height: 1;
            font-family: 'Bebas Neue', sans-serif;
            position: relative;
            z-index: 10;
        }
        
        .card-suit {
            font-size: 4rem;
            margin-top: -1rem;
            position: relative;
            z-index: 10;
        }
        
        .card-red { color: #e74c3c; }
        .card-black { color: #2c3e50; }
        
        .card-corners {
            position: absolute;
            font-size: 1.2rem;
            font-weight: 700;
            font-family: 'Bebas Neue', sans-serif;
            z-index: 10;
        }
        
        .corner-top {
            top: 12px;
            left: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            line-height: 1.2;
        }
        
        .corner-bottom {
            bottom: 12px;
            right: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            line-height: 1.2;
            transform: rotate(180deg);
        }
        
        .corner-suit { font-size: 1rem; }
        
        /* Blackjack Table */
        .blackjack-table {
            background: linear-gradient(135deg, #1a4d2e 0%, #0d2818 100%);
            border-radius: 200px;
            padding: 3rem 2rem;
            margin: 2rem auto;
            max-width: 1400px;
            border: 5px solid #2d5a3d;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                inset 0 0 100px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .dealer-area {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .dealer-label {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.5rem;
            color: var(--accent-gold);
            margin-bottom: 1rem;
            letter-spacing: 2px;
        }
        
        .dealer-cards {
            display: flex;
            justify-content: center;
            gap: -30px;
            min-height: 150px;
            align-items: center;
        }
        
        .dealer-total {
            font-size: 2rem;
            font-weight: 700;
            font-family: 'Bebas Neue', sans-serif;
            color: var(--text-primary);
            margin-top: 1rem;
        }
        
        .player-hands {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .player-hand {
            background: rgba(0, 0, 0, 0.3);
            border: 3px solid transparent;
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .player-hand.active {
            border-color: var(--accent-green);
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.3);
        }
        
        .player-hand.busted {
            border-color: var(--accent-red);
        }
        
        .player-hand.won {
            border-color: var(--accent-gold);
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
        }
        
        .player-hand.lost {
            border-color: var(--accent-red);
        }
        
        .player-hand.push {
            border-color: var(--accent-blue);
        }
        
        .hand-label {
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .hand-result {
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        .hand-cards {
            display: flex;
            justify-content: center;
            gap: -20px;
            min-height: 120px;
            align-items: center;
            margin-bottom: 2rem;
            position: relative;
        }
        
        .bj-card {
            width: 70px;
            height: 100px;
            background: white;
            border-radius: 8px;
            border: 2px solid #ddd;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            position: relative;
            transition: all 0.2s ease;
        }
        
        .bj-card:hover {
            transform: translateY(-5px);
        }
        
        .bj-card.face-down {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            border-color: #1e40af;
        }
        
        .bj-card-rank {
            font-size: 2rem;
            font-weight: 700;
            font-family: 'Bebas Neue', sans-serif;
        }
        
        .bj-card-suit {
            font-size: 1.5rem;
            margin-top: -0.5rem;
        }
        
        .bj-actions {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 2rem;
        }
        
        .bj-btn {
            padding: 1rem 2rem;
            font-size: 1.1rem;
            font-weight: 600;
            border: 2px solid var(--accent-green);
            border-radius: 12px;
            cursor: pointer;
            background: rgba(0, 255, 136, 0.1);
            color: var(--accent-green);
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }
        
        .bj-btn:hover {
            background: var(--accent-green);
            color: var(--bg-dark);
            transform: translateY(-2px);
        }
        
        .bj-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .bj-btn:disabled:hover {
            background: rgba(0, 255, 136, 0.1);
            color: var(--accent-green);
            transform: none;
        }
        
        .strategy-feedback {
            max-width: 600px;
            margin: 2rem auto;
            padding: 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            text-align: center;
            display: none;
        }
        
        .strategy-feedback.show { display: none !important; }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .strategy-feedback.correct {
            background: rgba(0, 255, 136, 0.1);
            border: 2px solid var(--accent-green);
            color: var(--accent-green);
        }
        
        .strategy-feedback.incorrect {
            background: rgba(255, 71, 87, 0.1);
            border: 2px solid var(--accent-red);
            color: var(--accent-red);
        }
        
        /* Deck Holder - SAME SIZE ALWAYS */
        .deck-holder {
            position: absolute;
            top: 20px;
            right: 40px;
            width: 80px;
        }
        
        .deck-stack {
            width: 100%;
            height: 120px;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            border-radius: 8px;
            border: 2px solid #1e40af;
            position: relative;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
        }
        
        .deck-stack::before,
        .deck-stack::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 120px;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            border-radius: 8px;
            border: 2px solid #1e40af;
        }
        
        .deck-stack::before {
            top: -3px;
            left: -3px;
            opacity: 0.7;
        }
        
        .deck-stack::after {
            top: -6px;
            left: -6px;
            opacity: 0.4;
        }
        
        /* Card Animations - MUCH FASTER */
        @keyframes dealCard {
            0% {
                transform: translate(var(--deal-from-x), var(--deal-from-y)) scale(0.3) rotateY(0deg);
                opacity: 0;
            }
            100% {
                transform: translate(0, 0) scale(1) rotateY(0deg);
                opacity: 1;
            }
        }
        
        @keyframes flipCard {
            0% {
                transform: rotateY(0deg);
            }
            50% {
                transform: rotateY(90deg);
            }
            100% {
                transform: rotateY(0deg);
            }
        }
        
        @keyframes celebration {
            0%, 100% {
                transform: scale(1);
            }
            25% {
                transform: scale(1.05) rotate(2deg);
            }
            75% {
                transform: scale(1.05) rotate(-2deg);
            }
        }
        
        .card-dealing {
            animation: dealCard 0.15s ease-out forwards;
        }
        
        .card-flipping {
            animation: flipCard 0.25s ease-out forwards;
        }
        
        .hand-celebrating {
            animation: celebration 0.4s ease-in-out;
        }
        
        /* Fireworks effect */
        .firework {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            animation: fireworkExpand 0.6s ease-out forwards;
        }
        
        @keyframes fireworkExpand {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--fx), var(--fy)) scale(0);
                opacity: 0;
            }
        }
        
        /* Control Buttons */
        .controls {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .control-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--bg-card);
            color: var(--text-primary);
            border: 3px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .control-btn:hover {
            transform: scale(1.1) translateY(-5px);
            border-color: var(--accent-green);
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.3);
        }
        
        /* Answer/Leaderboard sections remain the same */
        .answer-section {
            max-width: 600px;
            margin: 0 auto;
            background: var(--bg-card);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 3rem;
            text-align: center;
        }
        
        .answer-input {
            width: 100%;
            padding: 1.5rem;
            font-size: 2rem;
            text-align: center;
            background: var(--bg-surface);
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: var(--text-primary);
            font-weight: 700;
            margin-bottom: 2rem;
            font-family: 'Bebas Neue', sans-serif;
        }
        
        .answer-feedback {
            margin: 2rem 0;
            padding: 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1.2rem;
        }
        
        .answer-feedback.correct {
            background: rgba(0, 255, 136, 0.1);
            border: 2px solid var(--accent-green);
            color: var(--accent-green);
        }
        
        .answer-feedback.incorrect {
            background: rgba(255, 71, 87, 0.1);
            border: 2px solid var(--accent-red);
            color: var(--accent-red);
        }
        
        .leaderboard {
            max-width: 800px;
            margin: 3rem auto;
            background: var(--bg-card);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 3rem;
        }
        
        .leaderboard h2 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 3rem;
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .leaderboard-list {
            list-style: none;
        }
        
        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 1.5rem;
            margin-bottom: 1rem;
            background: var(--bg-surface);
            border-radius: 12px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .leaderboard-item:hover {
            border-color: var(--accent-green);
            transform: translateX(10px);
        }
        
        .leaderboard-item.rank-1 {
            border-color: var(--accent-gold);
            background: linear-gradient(90deg, rgba(255, 215, 0, 0.1), transparent);
        }
        
        .rank {
            font-size: 2rem;
            font-weight: 700;
            font-family: 'Bebas Neue', sans-serif;
            min-width: 60px;
            text-align: center;
        }
        
        .rank-1 .rank { color: var(--accent-gold); }
        
        .score-info {
            flex: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .score-cards {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--accent-green);
        }
        
        .hidden { display: none !important; }
        
        /* MOBILE APP REDESIGN - EVERYTHING VISIBLE AT ONCE */
        
    
        /* ========== MOBILE: MAKE EVERYTHING FIT 390px √ó 844px ========== */
        
        /* ========== MOBILE PERFECTION - EVERY PAGE FITS 844px ========== */
        @media (max-width: 768px) {
            /* GLOBAL - NO SCROLL */
            html, body {
                overflow: hidden;
                position: fixed;
                width: 100%;
                height: 100vh;
                margin: 0;
                padding: 0;
            }
            
            .container {
                overflow: hidden;
                height: 100vh;
                width: 100vw;
                padding: 0;
            }
            
            /* ===== HOME PAGE - FIT 844px ===== */
            .landing {
                height: 100vh;
                display: flex;
                flex-direction: column;
                justify-content: space-evenly;
                padding: 0.8rem;
                overflow: hidden;
            }
            
            .landing h1 {
                font-size: 2rem;
                margin: 0.3rem 0;
                letter-spacing: 1px;
            }
            
            .landing .subtitle {
                font-size: 0.8rem;
                margin-bottom: 0.5rem;
            }
            
            .card-preview {
                gap: 0.4rem;
                margin: 0.5rem 0;
            }
            
            .preview-card {
                width: 40px;
                height: 56px;
                font-size: 1.5rem;
            }
            
            .mode-selector {
                grid-template-columns: 1fr;
                gap: 0.8rem;
                margin: 0.5rem 0;
            }
            
            .mode-card {
                padding: 1rem;
                border-radius: 10px;
            }
            
            .mode-icon {
                font-size: 2rem;
                margin-bottom: 0.3rem;
            }
            
            .mode-title {
                font-size: 1.2rem;
                margin-bottom: 0.3rem;
            }
            
            .mode-desc {
                font-size: 0.75rem;
            }
            
            .time-options {
                gap: 0.5rem;
                margin: 0.5rem 0;
            }
            
            .time-btn {
                padding: 0.6rem 0.8rem;
                font-size: 0.8rem;
            }
            
            .btn {
                padding: 0.7rem 1rem;
                font-size: 0.85rem;
            }
            
            .btn-secondary {
                margin-left: 0.5rem;
            }
            
            /* ===== CARD COUNTING GAME - FIT 844px ===== */
            .game-page {
                height: 100vh;
                display: flex;
                flex-direction: column;
                padding: 0;
                overflow: hidden;
            }
            
            .game-header {
                gap: 0.4rem;
                padding: 0.4rem;
                background: rgba(0,0,0,0.3);
                flex-shrink: 0;
            }
            
            .stat-box {
                min-width: auto;
                padding: 0.5rem;
                flex: 1;
            }
            
            .stat-label {
                font-size: 0.65rem;
                margin-bottom: 0.2rem;
            }
            
            .stat-value {
                font-size: 1.2rem;
            }
            
            .card-area {
                flex: 1;
                display: flex;
                align-items: center;
                justify-content: center;
                min-height: 0;
            }
            
            .playing-card {
                width: 130px;
                height: 182px;
            }
            
            .card-rank {
                font-size: 3.5rem;
            }
            
            .card-suit {
                font-size: 2.5rem;
            }
            
            .card-corners {
                font-size: 0.9rem;
            }
            
            .corner-suit {
                font-size: 0.7rem;
            }
            
            .controls {
                gap: 0.5rem;
                padding: 0.5rem;
                flex-shrink: 0;
            }
            
            .control-btn {
                width: 50px;
                height: 50px;
                font-size: 1.3rem;
            }
            
            /* ===== BLACKJACK SETUP - FIT 844px ===== */
            #blackjack-setup {
                height: 100vh;
                overflow: hidden;
            }
            
            #blackjack-setup .answer-section {
                padding: 1rem;
                margin: 0;
                max-width: 100%;
                height: 100vh;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
            }
            
            #blackjack-setup h2 {
                font-size: 1.5rem;
                margin-bottom: 1rem;
            }
            
            #blackjack-setup .stat-label {
                font-size: 0.8rem;
                margin-bottom: 0.5rem;
            }
            
            /* ===== BLACKJACK GAME - FIT 844px ===== */
            #blackjack-game {
                height: 100vh;
                display: flex;
                flex-direction: column;
                padding: 0;
                overflow: hidden;
            }
            
            #blackjack-game .game-header {
                padding: 0.3rem;
            }
            
            #blackjack-game .stat-value {
                font-size: 1rem;
            }
            
            .strategy-feedback {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                z-index: 1000;
                padding: 0.6rem 1rem;
                font-size: 0.8rem;
            }
            
            .blackjack-table {
                flex: 1;
                display: flex;
                flex-direction: column;
                border-radius: 50px;
                padding: 0.5rem;
                margin: 0;
                overflow: hidden;
            }
            
            .dealer-area {
                padding: 0.3rem;
                flex-shrink: 0;
            }
            
            .dealer-label {
                font-size: 0.7rem;
                margin-bottom: 0.3rem;
            }
            
            .dealer-cards {
                gap: -12px;
                min-height: 50px;
            }
            
            .dealer-total {
                font-size: 1rem;
                margin-top: 0.3rem;
            }
            
            .player-hands {
                grid-template-columns: 1fr 1fr;
                gap: 0.4rem;
                padding: 0.4rem 0;
                flex: 1;
                overflow: visible;
                min-height: 0;
            }
            
            .player-hand {
                padding: 0.4rem;
                border-radius: 8px;
                display: flex;
                flex-direction: column;
                min-height: 0;
            }
            
            .hand-label {
                font-size: 0.65rem;
                margin-bottom: 0.3rem;
            }
            
            .hand-result {
                font-size: 0.75rem;
            }
            
            .hand-cards {
                gap: -12px;
                min-height: 50px;
                margin-bottom: 0.5rem;
                flex-wrap: wrap;
            }
            
            .bj-card {
                width: 38px;
                height: 54px;
            }
            
            .bj-card-rank {
                font-size: 1.2rem;
            }
            
            .bj-card-suit {
                font-size: 0.9rem;
            }
            
            .bj-actions {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 0.4rem;
                padding: 0.4rem;
                flex-shrink: 0;
                background: rgba(0,0,0,0.2);
            }
            
            .bj-btn {
                padding: 0.6rem 0.3rem;
                font-size: 0.7rem;
            }
            
            .deck-holder {
                width: 45px;
                top: 8px;
                right: 8px;
            }
            
            .deck-stack {
                height: 65px;
            }
            
            .deck-stack::before,
            .deck-stack::after {
                height: 65px;
            }
            
            /* BOTTOM BUTTONS - FULLY VISIBLE */
            #blackjack-game > div:last-child {
                padding: 0.5rem;
                flex-shrink: 0;
                background: rgba(0,0,0,0.3);
            }
            
            #blackjack-game > div:last-child .btn {
                padding: 0.7rem 1rem;
                font-size: 0.85rem;
                margin: 0.2rem;
            }
            
            /* ===== ANSWER PAGE - FIT 844px ===== */
            #answer-page {
                height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                overflow: hidden;
            }
            
            .answer-section {
                max-width: 90%;
                padding: 1.5rem;
                margin: 1rem;
            }
            
            .answer-section h2 {
                font-size: 1.5rem;
                margin-bottom: 1rem;
            }
            
            .answer-input {
                padding: 0.8rem;
                font-size: 1.5rem;
                margin-bottom: 1rem;
            }
            
            .answer-feedback {
                margin: 1rem 0;
                padding: 0.8rem;
                font-size: 0.9rem;
            }
            
            /* ===== LEADERBOARD - FIT 844px ===== */
            #leaderboard-page {
                height: 100vh;
                display: flex;
                flex-direction: column;
                overflow: hidden;
            }
            
            .leaderboard {
                max-width: 90%;
                margin: 0.5rem auto;
                padding: 1rem;
                flex: 1;
                overflow-y: auto;
            }
            
            .leaderboard h2 {
                font-size: 1.8rem;
                margin-bottom: 1rem;
            }
            
            .leaderboard-item {
                padding: 0.8rem;
                margin-bottom: 0.5rem;
            }
            
            .rank {
                font-size: 1.2rem;
                min-width: 40px;
            }
            
            .score-cards {
                font-size: 1rem;
            }
            
            /* ===== STRATEGY CHART - SCROLLABLE (ONLY ONE) ===== */
            #strategy-chart-page {
                height: 100vh;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .strategy-chart-container {
                padding: 1rem;
                padding-bottom: 3rem;
            }
            
            .strategy-chart-container h2 {
                font-size: 1.8rem;
                margin-bottom: 0.5rem;
            }
            
            .chart-subtitle {
                font-size: 0.8rem;
                margin-bottom: 1rem;
            }
            
            .chart-section {
                margin-bottom: 1.5rem;
            }
            
            .chart-section h3 {
                font-size: 1.2rem;
                margin-bottom: 0.5rem;
            }
            
            .strategy-table {
                font-size: 0.65rem;
            }
            
            .strategy-table th {
                padding: 0.3rem 0.1rem;
                font-size: 0.65rem;
            }
            
            .strategy-table td {
                padding: 0.3rem 0.1rem;
                font-size: 0.65rem;
            }
            
            .table-legend {
                font-size: 0.7rem;
                padding: 0.5rem;
                margin-top: 0.5rem;
            }
        }
        
        /* ========== EXTRA SMALL PHONES (< 375px) ========== */
        @media (max-width: 374px) {
            .landing h1 {
                font-size: 1.7rem;
            }
            
            .playing-card {
                width: 110px;
                height: 154px;
            }
            
            .card-rank {
                font-size: 3rem;
            }
            
            .bj-card {
                width: 34px;
                height: 48px;
            }
            
            .bj-btn {
                font-size: 0.65rem;
                padding: 0.5rem 0.2rem;
            }
        }


    </style>
</head>
<body>
    <div class="container">
        <!-- Landing Page -->
        <div id="landing-page" class="landing">
            <h1>BLACKJACK PRO TRAINER</h1>
            <p class="subtitle">Master card counting & blackjack strategy</p>
            
            <div class="card-preview">
                <div class="preview-card">üÇ°</div>
                <div class="preview-card">üÇÆ</div>
                <div class="preview-card">üÉÖ</div>
                <div class="preview-card">üÉã</div>
            </div>
            
            <div class="mode-selector">
                <div class="mode-card" onclick="app.selectMode('counting')">
                    <div class="mode-icon">‚ö°</div>
                    <div class="mode-title">CARD COUNTING</div>
                    <div class="mode-desc">Race against time to count cards and master the Hi-Lo system</div>
                </div>
                
                <div class="mode-card" onclick="app.selectMode('blackjack')">
                    <div class="mode-icon">üÉè</div>
                    <div class="mode-title">BLACKJACK TRAINER</div>
                    <div class="mode-desc">Perfect your basic strategy with 4-hand play and instant feedback</div>
                </div>
            </div>
            
            <div id="counting-options" class="hidden">
                <div class="time-options">
                    <button class="time-btn selected" onclick="app.selectTime(30)">30 Seconds</button>
                    <button class="time-btn" onclick="app.selectTime(60)">1 Minute</button>
                    <button class="time-btn" onclick="app.selectTime(120)">2 Minutes</button>
                </div>
                
                <div>
                    <button class="btn btn-primary" onclick="app.startCounting()">START COUNTING</button>
                    <button class="btn btn-secondary" onclick="app.showLeaderboard()">LEADERBOARD</button>
                </div>
            </div>
            
            <div id="blackjack-options" class="hidden">
                <div>
                    <button class="btn btn-primary" onclick="app.startBlackjack()">PLAY BLACKJACK</button>
                    <button class="btn btn-secondary" onclick="app.showLeaderboard()">BEST STREAKS</button>
                    <button class="btn btn-secondary" onclick="app.showStrategyChart()">STRATEGY CHART</button>
                </div>
            </div>
        </div>

        <!-- Card Counting Game (existing) -->
        <div id="counting-game" class="game-page hidden">
            <div class="game-header">
                <div class="stat-box">
                    <div class="stat-label">Time Left</div>
                    <div class="stat-value timer" id="timer">30</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Cards Seen</div>
                    <div class="stat-value cards-seen" id="cards-seen">0</div>
                </div>
            </div>
            
            <div class="card-area">
                <div class="playing-card skin-classic" id="playing-card" onclick="countingGame.nextCard()">
                    <div class="card-face" id="card-face">
                        <div class="card-corners corner-top">
                            <span class="corner-rank">A</span>
                            <span class="corner-suit">‚ô†</span>
                        </div>
                        <span class="card-rank">A</span>
                        <span class="card-suit">‚ô†</span>
                        <div class="card-corners corner-bottom">
                            <span class="corner-rank">A</span>
                            <span class="corner-suit">‚ô†</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="controls">
                <button class="control-btn" onclick="countingGame.nextCard()">‚ñ∂</button>
                <button class="control-btn" onclick="countingGame.pauseGame()" id="pause-btn">‚è∏</button>
                <button class="control-btn" onclick="countingGame.quitGame()">‚úï</button>
            </div>
        </div>

        <!-- Blackjack Setup -->
        <div id="blackjack-setup" class="game-page hidden">
            <div class="answer-section">
                <h2>Blackjack Settings</h2>
                
                <div style="margin: 2rem 0;">
                    <div class="stat-label">Number of Decks</div>
                    <div class="time-options">
                        <button class="time-btn selected" onclick="blackjackGame.selectDecks(1)">1 Deck</button>
                        <button class="time-btn" onclick="blackjackGame.selectDecks(2)">2 Decks</button>
                        <button class="time-btn" onclick="blackjackGame.selectDecks(4)">4 Decks</button>
                        <button class="time-btn" onclick="blackjackGame.selectDecks(6)">6 Decks</button>
                        <button class="time-btn" onclick="blackjackGame.selectDecks(8)">8 Decks</button>
                    </div>
                </div>
                
                <div style="margin: 2rem 0;">
                    <div class="stat-label">Training Mode</div>
                    <div class="time-options">
                        <button class="time-btn selected" onclick="blackjackGame.selectMode('normal')">Normal</button>
                        <button class="time-btn" onclick="blackjackGame.selectMode('splits')">Splits Only</button>
                        <button class="time-btn" onclick="blackjackGame.selectMode('soft')">Soft Hands Only</button>
                    </div>
                </div>
                
                <div style="margin: 2rem 0;">
                    <button class="btn btn-primary" onclick="blackjackGame.startSession()">START PLAYING</button>
                    <button class="btn btn-secondary" onclick="app.backToHome()">BACK</button>
                </div>
            </div>
        </div>

        <!-- Blackjack Game -->
        <div id="blackjack-game" class="game-page hidden">
            <div class="game-header">
                <div class="stat-box">
                    <div class="stat-label">Perfect Streak</div>
                    <div class="stat-value" style="color: var(--accent-gold); font-size: 2rem;" id="perfect-streak">0</div>
                </div>
            </div>
            
            <div class="strategy-feedback" id="strategy-feedback"></div>
            
            <div class="blackjack-table">
                <!-- Deck Holder -->
                <div class="deck-holder" id="deck-holder">
                    <div class="deck-stack"></div>
                </div>
                
                <div class="dealer-area">
                    <div class="dealer-label">DEALER</div>
                    <div class="dealer-cards" id="dealer-cards"></div>
                </div>
                
                <div class="player-hands" id="player-hands"></div>
                
                <div class="bj-actions" id="bj-actions">
                    <button class="bj-btn" onclick="blackjackGame.hit()">HIT</button>
                    <button class="bj-btn" onclick="blackjackGame.stand()">STAND</button>
                    <button class="bj-btn" onclick="blackjackGame.double()">DOUBLE</button>
                    <button class="bj-btn" onclick="blackjackGame.split()">SPLIT</button>
                    <button class="bj-btn" onclick="blackjackGame.surrender()">SURRENDER</button>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 2rem;">
                <button class="btn btn-primary" onclick="blackjackGame.nextRound()" id="next-round-btn" disabled>NEXT ROUND</button>
                <button class="btn btn-secondary" onclick="blackjackGame.quitGame()">END SESSION</button>
            </div>
        </div>

        <!-- Answer Page (counting mode) -->
        <div id="answer-page" class="answer-section hidden">
            <h2>What's the Count?</h2>
            <p>You counted <strong><span id="total-cards">0</span> cards</strong>. Enter your final count:</p>
            <input type="number" class="answer-input" id="count-input" placeholder="0"/>
            <div id="answer-feedback" class="answer-feedback hidden"></div>
            <div>
                <button class="btn btn-primary" onclick="countingGame.submitAnswer()" id="submit-btn">SUBMIT</button>
            </div>
            <div style="margin-top: 2rem;">
                <button class="btn btn-secondary" onclick="app.backToHome()">BACK</button>
            </div>
        </div>

        <!-- Leaderboard -->
        <div id="leaderboard-page" class="hidden">
            <div class="leaderboard">
                <h2 id="leaderboard-title">üèÜ WINNERS üèÜ</h2>
                <ul class="leaderboard-list" id="leaderboard-list"></ul>
            </div>
            <div style="text-align: center; margin-top: 2rem;">
                <button class="btn btn-secondary" onclick="app.backToHome()">BACK</button>
            </div>
        </div>
    
        <!-- Basic Strategy Chart -->
        <div id="strategy-chart-page" class="hidden">
            <div class="strategy-chart-container">
                <h2>BASIC STRATEGY CHART</h2>
                <p class="chart-subtitle">Optimal play for every situation</p>
                
                <div class="chart-section">
                    <h3>HARD TOTALS</h3>
                    <table class="strategy-table">
                        <thead>
                            <tr>
                                <th>Your Hand</th>
                                <th>2</th>
                                <th>3</th>
                                <th>4</th>
                                <th>5</th>
                                <th>6</th>
                                <th>7</th>
                                <th>8</th>
                                <th>9</th>
                                <th>10</th>
                                <th>A</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>17-20</td><td colspan="10" class="stand">STAND</td></tr>
                            <tr><td>16</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="hit">H</td><td class="hit">H</td><td class="surrender">R</td><td class="surrender">R</td><td class="surrender">R</td></tr>
                            <tr><td>15</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="surrender">R</td><td class="hit">H</td></tr>
                            <tr><td>13-14</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td></tr>
                            <tr><td>12</td><td class="hit">H</td><td class="hit">H</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td></tr>
                            <tr><td>11</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="hit">H</td></tr>
                            <tr><td>10</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="hit">H</td><td class="hit">H</td></tr>
                            <tr><td>9</td><td class="hit">H</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td></tr>
                            <tr><td>5-8</td><td colspan="10" class="hit">HIT</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="chart-section">
                    <h3>SOFT TOTALS</h3>
                    <table class="strategy-table">
                        <thead>
                            <tr>
                                <th>Your Hand</th>
                                <th>2</th>
                                <th>3</th>
                                <th>4</th>
                                <th>5</th>
                                <th>6</th>
                                <th>7</th>
                                <th>8</th>
                                <th>9</th>
                                <th>10</th>
                                <th>A</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>A,9</td><td colspan="10" class="stand">STAND</td></tr>
                            <tr><td>A,8</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td><td class="stand">S</td></tr>
                            <tr><td>A,7</td><td class="stand">S</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="stand">S</td><td class="stand">S</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td></tr>
                            <tr><td>A,6</td><td class="hit">H</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td></tr>
                            <tr><td>A,4-5</td><td class="hit">H</td><td class="hit">H</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td></tr>
                            <tr><td>A,2-3</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="double">D</td><td class="double">D</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="chart-section">
                    <h3>PAIRS</h3>
                    <table class="strategy-table">
                        <thead>
                            <tr>
                                <th>Your Hand</th>
                                <th>2</th>
                                <th>3</th>
                                <th>4</th>
                                <th>5</th>
                                <th>6</th>
                                <th>7</th>
                                <th>8</th>
                                <th>9</th>
                                <th>10</th>
                                <th>A</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>A,A</td><td colspan="10" class="split">SPLIT</td></tr>
                            <tr><td>10,10</td><td colspan="10" class="stand">STAND</td></tr>
                            <tr><td>9,9</td><td class="split">P</td><td class="split">P</td><td class="split">P</td><td class="split">P</td><td class="split">P</td><td class="stand">S</td><td class="split">P</td><td class="split">P</td><td class="stand">S</td><td class="stand">S</td></tr>
                            <tr><td>8,8</td><td colspan="10" class="split">SPLIT</td></tr>
                            <tr><td>7,7</td><td class="split">P</td><td class="split">P</td><td class="split">P</td><td class="split">P</td><td class="split">P</td><td class="split">P</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td></tr>
                            <tr><td>6,6</td><td class="hit">H</td><td class="split">P</td><td class="split">P</td><td class="split">P</td><td class="split">P</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td></tr>
                            <tr><td>5,5</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="double">D</td><td class="hit">H</td><td class="hit">H</td></tr>
                            <tr><td>4,4</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="split">P</td><td class="split">P</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td></tr>
                            <tr><td>2,2-3,3</td><td class="hit">H</td><td class="hit">H</td><td class="split">P</td><td class="split">P</td><td class="split">P</td><td class="split">P</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td><td class="hit">H</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="legend">
                    <div class="legend-item"><span class="legend-box hit">H</span> Hit</div>
                    <div class="legend-item"><span class="legend-box stand">S</span> Stand</div>
                    <div class="legend-item"><span class="legend-box double">D</span> Double</div>
                    <div class="legend-item"><span class="legend-box split">P</span> Split</div>
                    <div class="legend-item"><span class="legend-box surrender">R</span> Surrender</div>
                </div>
                
                <div style="text-align: center; margin-top: 2rem;">
                    <button class="btn btn-secondary" onclick="app.backToHome()">BACK TO HOME</button>
                </div>
            </div>
        </div>

    </div>

    <script>
        // Main App Controller
        const app = {
            currentMode: null,
            selectedTime: 30,
            selectedSkin: 'classic',
            
            init() {
                this.loadSettings();
                this.setupKeyboard();
            },
            
            loadSettings() {
                this.selectedSkin = localStorage.getItem('cardSkin') || 'classic';
                this.updateSkinSelection();
            },
            
            selectMode(mode) {
                this.currentMode = mode;
                document.getElementById('counting-options').classList.toggle('hidden', mode !== 'counting');
                document.getElementById('blackjack-options').classList.toggle('hidden', mode !== 'blackjack');
            },
            
            selectTime(seconds) {
                this.selectedTime = seconds;
                document.querySelectorAll('.time-btn').forEach(btn => btn.classList.remove('selected'));
                event.target.classList.add('selected');
            },
            
            selectSkin(skin) {
                this.selectedSkin = skin;
                localStorage.setItem('cardSkin', skin);
                this.updateSkinSelection();
            },
            
            updateSkinSelection() {
                document.querySelectorAll('.skin-option').forEach((opt, i) => {
                    const skins = ['classic', 'vintage', 'cyberpunk', 'luxury', 'hacker', 'royal'];
                    opt.classList.toggle('selected', skins[i] === this.selectedSkin);
                });
            },
            
            startCounting() {
                countingGame.start(this.selectedTime, this.selectedSkin);
            },
            
            startBlackjack() {
                blackjackGame.start();
            },
            
            showStrategyChart() {
                this.showPage('strategy-chart-page');
            },
            
            showLeaderboard() {
                const board = this.currentMode === 'counting' ? countingGame.getLeaderboard() : blackjackGame.getLeaderboard();
                const listEl = document.getElementById('leaderboard-list');
                document.getElementById('leaderboard-title').textContent = 
                    this.currentMode === 'counting' ? 'üèÜ COUNTING WINNERS üèÜ' : 'üèÜ PERFECT STREAKS üèÜ';
                
                if (!board.length) {
                    listEl.innerHTML = '<li style="text-align:center;padding:3rem;color:var(--text-secondary)">No records yet!</li>';
                } else {
                    listEl.innerHTML = board.map((score, i) => `
                        <li class="leaderboard-item rank-${i+1<=3?i+1:''}">
                            <div class="rank">#${i+1}</div>
                            <div class="score-info">
                                <div class="score-cards">${this.currentMode==='counting'?score.cards+' cards':'Streak: '+score.streak}</div>
                                <div style="color:var(--text-secondary);font-size:0.9rem">${new Date(score.date).toLocaleDateString()}</div>
                            </div>
                        </li>
                    `).join('');
                }
                this.showPage('leaderboard-page');
            },
            
            showPage(page) {
                ['landing-page', 'counting-game', 'blackjack-setup', 'blackjack-game', 'answer-page', 'leaderboard-page', 'strategy-chart-page'].forEach(p => {
                    document.getElementById(p)?.classList.add('hidden');
                });
                document.getElementById(page)?.classList.remove('hidden');
            },
            
            backToHome() {
                this.showPage('landing-page');
            },
            
            setupKeyboard() {
                document.getElementById('count-input')?.addEventListener('keypress', e => {
                    if (e.key === 'Enter') countingGame.submitAnswer();
                });
            }
        };

        // Card Counting Game Logic
        const countingGame = {
            deck: [], cardsSeen: 0, runningCount: 0, timeLeft: 30, timer: null,
            active: false, paused: false, attempts: 0,
            
            cardValues: {'2':1,'3':1,'4':1,'5':1,'6':1,'7':0,'8':0,'9':0,'10':-1,'J':-1,'Q':-1,'K':-1,'A':-1},
            suits: {hearts:{symbol:'‚ô•',color:'card-red'},diamonds:{symbol:'‚ô¶',color:'card-red'},
                    clubs:{symbol:'‚ô£',color:'card-black'},spades:{symbol:'‚ô†',color:'card-black'}},
            ranks: ['2','3','4','5','6','7','8','9','10','J','Q','K','A'],
            
            start(time, skin) {
                this.timeLeft = time;
                this.cardsSeen = 0;
                this.runningCount = 0;
                this.attempts = 0;
                this.createDeck();
                document.getElementById('playing-card').className = 'playing-card skin-' + skin;
                app.showPage('counting-game');
                this.active = true;
                this.paused = false;
                this.timer = setInterval(() => this.tick(), 1000);
                this.nextCard();
            },
            
            createDeck() {
                this.deck = [];
                for(let i=0; i<10; i++) {
                    Object.keys(this.suits).forEach(suit => {
                        this.ranks.forEach(rank => {
                            this.deck.push({rank, suit, value: this.cardValues[rank]});
                        });
                    });
                }
                this.deck.sort(() => Math.random()-0.5);
            },
            
            nextCard() {
                if (!this.active || this.paused) return;
                if (this.deck.length < 20) this.createDeck();
                
                const card = this.deck.pop();
                this.cardsSeen++;
                this.runningCount += card.value;
                
                const suit = this.suits[card.suit];
                const face = document.getElementById('card-face');
                face.querySelectorAll('.card-rank, .corner-rank').forEach(el => el.textContent = card.rank);
                face.querySelectorAll('.card-suit, .corner-suit').forEach(el => el.textContent = suit.symbol);
                face.querySelectorAll('.card-rank, .corner-rank, .card-suit, .corner-suit').forEach(el => {
                    el.classList.remove('card-red', 'card-black');
                    el.classList.add(suit.color);
                });
                
                this.updateDisplay();
                document.getElementById('playing-card').classList.remove('flipping');
                setTimeout(() => document.getElementById('playing-card').classList.add('flipping'), 10);
            },
            
            updateDisplay() {
                document.getElementById('timer').textContent = this.timeLeft;
                document.getElementById('cards-seen').textContent = this.cardsSeen;
                const timerEl = document.getElementById('timer');
                timerEl.classList.remove('warning', 'critical');
                if (this.timeLeft <= 5) timerEl.classList.add('critical');
                else if (this.timeLeft <= 10) timerEl.classList.add('warning');
            },
            
            tick() {
                if (!this.paused) {
                    this.timeLeft--;
                    this.updateDisplay();
                    if (this.timeLeft <= 0) this.end();
                }
            },
            
            pauseGame() {
                this.paused = !this.paused;
                document.getElementById('pause-btn').textContent = this.paused ? '‚ñ∂' : '‚è∏';
            },
            
            quitGame() {
                if (confirm('Quit? Progress will be lost.')) {
                    clearInterval(this.timer);
                    this.active = false;
                    app.backToHome();
                }
            },
            
            end() {
                clearInterval(this.timer);
                this.active = false;
                document.getElementById('total-cards').textContent = this.cardsSeen;
                document.getElementById('count-input').value = '';
                document.getElementById('answer-feedback').classList.add('hidden');
                app.showPage('answer-page');
                setTimeout(() => document.getElementById('count-input').focus(), 100);
            },
            
            submitAnswer() {
                const answer = parseInt(document.getElementById('count-input').value);
                this.attempts++;
                
                if (answer === this.runningCount) {
                    document.getElementById('answer-feedback').textContent = '‚úì PERFECT! ' + this.cardsSeen + ' cards!';
                    document.getElementById('answer-feedback').className = 'answer-feedback correct';
                    document.getElementById('answer-feedback').classList.remove('hidden');
                    this.saveScore();
                    document.getElementById('submit-btn').textContent = 'LEADERBOARD';
                    document.getElementById('submit-btn').onclick = () => app.showLeaderboard();
                } else {
                    document.getElementById('answer-feedback').textContent = `‚úó Incorrect. Count was ${this.runningCount>=0?'+':''}${this.runningCount}. Try again!`;
                    document.getElementById('answer-feedback').className = 'answer-feedback incorrect';
                    document.getElementById('answer-feedback').classList.remove('hidden');
                    document.getElementById('count-input').value = '';
                }
            },
            
            saveScore() {
                const scores = JSON.parse(localStorage.getItem('countingScores') || '[]');
                scores.push({cards: this.cardsSeen, date: new Date().toISOString()});
                scores.sort((a,b) => b.cards - a.cards);
                localStorage.setItem('countingScores', JSON.stringify(scores.slice(0, 10)));
            },
            
            getLeaderboard() {
                return JSON.parse(localStorage.getItem('countingScores') || '[]');
            }
        };

        // Blackjack Game Logic
        const blackjackGame = {
            numDecks: 6,
            trainingMode: 'normal',
            deck: [],
            dealer: {cards: []},
            hands: [],
            currentHand: 0,
            perfectStreak: 0,
            roundOver: false,
            dealerPlaying: false,
            
            ranks: ['2','3','4','5','6','7','8','9','10','J','Q','K','A'],
            suits: ['hearts','diamonds','clubs','spades'],
            suitSymbols: {hearts:'‚ô•',diamonds:'‚ô¶',clubs:'‚ô£',spades:'‚ô†'},
            
            start() {
                this.perfectStreak = parseInt(localStorage.getItem('bjPerfectStreak') || '0');
                app.showPage('blackjack-setup');
            },
            
            selectDecks(num) {
                this.numDecks = num;
                const btns = document.querySelectorAll('#blackjack-setup .time-btn');
                btns.forEach((btn, i) => {
                    btn.classList.toggle('selected', [1,2,4,6,8][i] === num);
                });
            },
            
            selectMode(mode) {
                this.trainingMode = mode;
                const btns = document.querySelectorAll('#blackjack-setup .time-options')[1].querySelectorAll('.time-btn');
                btns.forEach((btn, i) => {
                    btn.classList.toggle('selected', ['normal','splits','soft'][i] === mode);
                });
            },
            
            startSession() {
                this.createDeck();
                app.showPage('blackjack-game');
                document.getElementById('perfect-streak').textContent = this.perfectStreak;
                this.startRound();
            },
            
            async startRound() {
                this.dealer = {cards: []};
                this.hands = [];
                this.currentHand = 0;
                this.roundOver = false;
                this.dealerPlaying = false;
                document.getElementById('next-round-btn').disabled = true;
                
                // Clear previous render
                document.getElementById('dealer-cards').innerHTML = '';
                document.getElementById('player-hands').innerHTML = '';
                
                // Create hands based on training mode
                if (this.trainingMode === 'splits') {
                    const rank = this.ranks[Math.floor(Math.random() * this.ranks.length)];
                    this.hands.push({
                        cards: [],
                        active: true,
                        stood: false,
                        busted: false,
                        surrendered: false
                    });
                    // Will deal pair below
                    await this.dealCardToHand(this.hands[0], {rank, suit: this.suits[0]});
                    await this.dealCardToHand(this.hands[0], {rank, suit: this.suits[1]});
                } else if (this.trainingMode === 'soft') {
                    this.hands.push({
                        cards: [],
                        active: true,
                        stood: false,
                        busted: false,
                        surrendered: false
                    });
                    await this.dealCardToHand(this.hands[0], {rank: 'A', suit: this.suits[0]});
                    await this.dealCardToHand(this.hands[0], this.dealCard());
                } else {
                    // Normal 4 hands
                    for(let i=0; i<4; i++) {
                        this.hands.push({
                            cards: [],
                            active: i === 0,
                            stood: false,
                            busted: false,
                            surrendered: false
                        });
                    }
                    
                    // Deal initial cards - MUCH FASTER
                    for(let hand of this.hands) {
                        await this.dealCardToHand(hand, this.dealCard());
                        await this.sleep(50);
                    }
                    await this.sleep(100);
                    for(let hand of this.hands) {
                        await this.dealCardToHand(hand, this.dealCard());
                        await this.sleep(50);
                    }
                }
                
                // Deal dealer cards - MUCH FASTER
                await this.dealCardToDealer(this.dealCard());
                await this.sleep(50);
                await this.dealCardToDealer({faceDown: true, actualCard: this.dealCard()});
                
                this.render();
                this.hideFeedback();
                this.enableActions(true);
            },
            
            createDeck() {
                this.deck = [];
                for(let d=0; d<this.numDecks; d++) {
                    this.suits.forEach(suit => {
                        this.ranks.forEach(rank => {
                            this.deck.push({rank, suit});
                        });
                    });
                }
                this.deck.sort(() => Math.random()-0.5);
            },
            
            dealCard() {
                if (this.deck.length < 10) this.createDeck();
                return this.deck.pop();
            },
            
            async dealCardToHand(hand, card) {
                hand.cards.push(card);
                this.render();
                
                // Get the last card element and animate it
                const handEl = document.getElementById('player-hands').children[this.hands.indexOf(hand)];
                if (handEl) {
                    const cards = handEl.querySelector('.hand-cards').children;
                    const lastCard = cards[cards.length - 1];
                    if (lastCard) {
                        const deckPos = document.getElementById('deck-holder').getBoundingClientRect();
                        const cardPos = lastCard.getBoundingClientRect();
                        lastCard.style.setProperty('--deal-from-x', (deckPos.left - cardPos.left) + 'px');
                        lastCard.style.setProperty('--deal-from-y', (deckPos.top - cardPos.top) + 'px');
                        lastCard.classList.add('card-dealing');
                    }
                }
                
                await this.sleep(100);
            },
            
            async dealCardToDealer(card) {
                this.dealer.cards.push(card);
                this.render();
                
                const dealerEl = document.getElementById('dealer-cards');
                const cards = dealerEl.children;
                const lastCard = cards[cards.length - 1];
                if (lastCard) {
                    const deckPos = document.getElementById('deck-holder').getBoundingClientRect();
                    const cardPos = lastCard.getBoundingClientRect();
                    lastCard.style.setProperty('--deal-from-x', (deckPos.left - cardPos.left) + 'px');
                    lastCard.style.setProperty('--deal-from-y', (deckPos.top - cardPos.top) + 'px');
                    lastCard.classList.add('card-dealing');
                }
                
                await this.sleep(100);
            },
            
            calculateTotal(cards) {
                let total = 0, aces = 0;
                cards.forEach(card => {
                    if (card.faceDown) return;
                    const rank = card.rank || (card.actualCard && card.actualCard.rank);
                    if (rank === 'A') aces++;
                    else if (['J','Q','K'].includes(rank)) total += 10;
                    else total += parseInt(rank);
                });
                
                for(let i=0; i<aces; i++) {
                    if (total + 11 <= 21) total += 11;
                    else total += 1;
                }
                
                return total;
            },
            
            async hit() {
                const hand = this.hands[this.currentHand];
                if (this.roundOver || !hand || hand.stood || hand.busted || hand.surrendered) return;
                
                const correct = this.getCorrectAction();
                this.checkDecision('H', correct);
                
                await this.dealCardToHand(hand, this.dealCard());
                const total = this.calculateTotal(hand.cards);
                
                if (total > 21) {
                    hand.busted = true;
                    hand.active = false;
                    this.nextHand();
                } else if (total === 21) {
                    hand.stood = true;
                    hand.active = false;
                    this.nextHand();
                }
                
                this.render();
            },
            
            stand() {
                const hand = this.hands[this.currentHand];
                if (this.roundOver || !hand || hand.stood || hand.busted || hand.surrendered) return;
                
                const correct = this.getCorrectAction();
                this.checkDecision('S', correct);
                
                hand.stood = true;
                hand.active = false;
                this.nextHand();
                this.render();
            },
            
            async double() {
                const hand = this.hands[this.currentHand];
                if (this.roundOver || !hand || hand.cards.length !== 2) return;
                
                const correct = this.getCorrectAction();
                this.checkDecision('D', correct);
                
                await this.dealCardToHand(hand, this.dealCard());
                hand.stood = true;
                hand.active = false;
                
                if (this.calculateTotal(hand.cards) > 21) {
                    hand.busted = true;
                }
                
                this.nextHand();
                this.render();
            },
            
            async split() {
                const hand = this.hands[this.currentHand];
                if (this.roundOver || !hand || hand.cards.length !== 2) return;
                if (hand.cards[0].rank !== hand.cards[1].rank) return;
                
                const correct = this.getCorrectAction();
                this.checkDecision('P', correct);
                
                // Split into two hands
                const newHand = {
                    cards: [hand.cards.pop()],
                    active: false,
                    stood: false,
                    busted: false,
                    surrendered: false
                };
                
                await this.dealCardToHand(hand, this.dealCard());
                await this.dealCardToHand(newHand, this.dealCard());
                
                this.hands.splice(this.currentHand + 1, 0, newHand);
                
                this.render();
            },
            
            surrender() {
                const hand = this.hands[this.currentHand];
                if (this.roundOver || !hand || hand.cards.length !== 2) return;
                
                const correct = this.getCorrectAction();
                this.checkDecision('R', correct);
                
                hand.surrendered = true;
                hand.active = false;
                this.nextHand();
                this.render();
            },
            
            nextHand() {
                do {
                    this.currentHand++;
                } while (this.currentHand < this.hands.length && 
                         (this.hands[this.currentHand].busted || 
                          this.hands[this.currentHand].stood ||
                          this.hands[this.currentHand].surrendered));
                
                if (this.currentHand < this.hands.length) {
                    this.hands[this.currentHand].active = true;
                    this.render();
                } else {
                    this.dealerPlay();
                }
            },
            
            async dealerPlay() {
                this.dealerPlaying = true;
                this.roundOver = true;
                this.enableActions(false);
                
                await this.sleep(150);
                
                // Reveal hole card with flip animation - FASTER
                const holeCard = this.dealer.cards.find(c => c.faceDown);
                if (holeCard) {
                    const dealerEl = document.getElementById('dealer-cards');
                    const holeCardEl = dealerEl.children[1];
                    if (holeCardEl) {
                        holeCardEl.classList.add('card-flipping');
                        await this.sleep(125);
                    }
                    
                    // Actually reveal it
                    const actualCard = holeCard.actualCard;
                    this.dealer.cards[1] = actualCard;
                    this.render();
                    await this.sleep(150);
                }
                
                // Dealer hits to 17 - FASTER
                let dealerTotal = this.calculateTotal(this.dealer.cards);
                while (dealerTotal < 17) {
                    await this.dealCardToDealer(this.dealCard());
                    dealerTotal = this.calculateTotal(this.dealer.cards);
                    await this.sleep(150);
                }
                
                // Determine winners - FASTER
                await this.sleep(150);
                await this.resolveHands(dealerTotal);
            },
            
            async resolveHands(dealerTotal) {
                const dealerBusted = dealerTotal > 21;
                
                for(let i=0; i<this.hands.length; i++) {
                    const hand = this.hands[i];
                    
                    if (hand.busted || hand.surrendered) {
                        hand.result = 'LOST';
                        hand.lost = true;
                        continue;
                    }
                    
                    const handTotal = this.calculateTotal(hand.cards);
                    
                    if (dealerBusted || handTotal > dealerTotal) {
                        hand.result = 'WIN';
                        hand.won = true;
                        await this.celebrateHand(i);
                    } else if (handTotal === dealerTotal) {
                        hand.result = 'PUSH';
                        hand.push = true;
                    } else {
                        hand.result = 'LOST';
                        hand.lost = true;
                    }
                    
                    await this.sleep(150);
                }
                
                this.render();
                document.getElementById('next-round-btn').disabled = false;
            },
            
            async celebrateHand(handIndex) {
                const handEl = document.getElementById('player-hands').children[handIndex];
                if (handEl) {
                    handEl.classList.add('hand-celebrating');
                    
                    // Create fireworks
                    const rect = handEl.getBoundingClientRect();
                    const centerX = rect.left + rect.width / 2;
                    const centerY = rect.top + rect.height / 2;
                    
                    for(let i=0; i<12; i++) {
                        const firework = document.createElement('div');
                        firework.className = 'firework';
                        const angle = (i / 12) * Math.PI * 2;
                        const distance = 100;
                        firework.style.setProperty('--fx', Math.cos(angle) * distance + 'px');
                        firework.style.setProperty('--fy', Math.sin(angle) * distance + 'px');
                        firework.style.left = centerX + 'px';
                        firework.style.top = centerY + 'px';
                        firework.style.background = ['#ffd700', '#00ff88', '#00d4ff'][i % 3];
                        document.body.appendChild(firework);
                        
                        setTimeout(() => firework.remove(), 600);
                    }
                    
                    await this.sleep(400);
                    handEl.classList.remove('hand-celebrating');
                }
            },
            
            nextRound() {
                document.getElementById('next-round-btn').disabled = true;
                this.startRound();
            },
            
            checkDecision(action, correct) {
                if (action === correct) {
                    // Feedback removed
                    this.perfectStreak++;
                    localStorage.setItem('bjPerfectStreak', this.perfectStreak);
                    document.getElementById('perfect-streak').textContent = this.perfectStreak;
                    this.saveStreak();
                } else {
                    const actions = {H:'HIT',S:'STAND',D:'DOUBLE',P:'SPLIT',R:'SURRENDER'};
                    // Feedback removed
                    this.perfectStreak = 0;
                    localStorage.setItem('bjPerfectStreak', '0');
                    document.getElementById('perfect-streak').textContent = '0';
                }
            },
            
            getCorrectAction() {
                const hand = this.hands[this.currentHand];
                const dealerUp = this.dealer.cards[0];
                const dealerValue = dealerUp.rank === 'A' ? 11 : ['J','Q','K'].includes(dealerUp.rank) ? 10 : parseInt(dealerUp.rank);
                const handTotal = this.calculateTotal(hand.cards);
                
                // PAIRS
                if (hand.cards.length === 2 && hand.cards[0].rank === hand.cards[1].rank) {
                    const rank = hand.cards[0].rank;
                    if (['A','8'].includes(rank)) return 'P';
                    if (rank === '10' || ['J','Q','K'].includes(rank)) return 'S';
                    if (rank === '9' && ![7,10,11].includes(dealerValue)) return 'P';
                    if (rank === '7' && dealerValue <= 7) return 'P';
                    if (rank === '6' && dealerValue >= 3 && dealerValue <= 6) return 'P';
                    if (rank === '5') return dealerValue <= 9 ? 'D' : 'H';
                    if (rank === '4') return 'H';
                    if (['2','3'].includes(rank) && dealerValue >= 4 && dealerValue <= 7) return 'P';
                }
                
                // SOFT
                const hasAce = hand.cards.some(c => c.rank === 'A') && handTotal <= 21;
                if (hasAce && handTotal < 21) {
                    if (handTotal === 20) return 'S';
                    if (handTotal === 19) return 'S';
                    if (handTotal === 18) {
                        if (dealerValue >= 2 && dealerValue <= 6 && hand.cards.length === 2) return 'D';
                        if (dealerValue >= 7 && dealerValue <= 8) return 'S';
                        return 'H';
                    }
                    if (handTotal === 17 && dealerValue >= 3 && dealerValue <= 6 && hand.cards.length === 2) return 'D';
                    if (handTotal === 17) return 'H';
                    if (handTotal >= 15 && handTotal <= 16 && dealerValue >= 4 && dealerValue <= 6 && hand.cards.length === 2) return 'D';
                    if (handTotal >= 15 && handTotal <= 16) return 'H';
                    if (handTotal >= 13 && handTotal <= 14 && dealerValue >= 5 && dealerValue <= 6 && hand.cards.length === 2) return 'D';
                    return 'H';
                }
                
                // HARD
                if (handTotal >= 17) return 'S';
                if (handTotal === 16) {
                    if (dealerValue >= 2 && dealerValue <= 6) return 'S';
                    if (hand.cards.length === 2 && dealerValue >= 9) return 'R';
                    return 'H';
                }
                if (handTotal === 15) {
                    if (dealerValue >= 2 && dealerValue <= 6) return 'S';
                    if (hand.cards.length === 2 && dealerValue === 10) return 'R';
                    return 'H';
                }
                if (handTotal >= 13 && handTotal <= 14) return (dealerValue >= 2 && dealerValue <= 6) ? 'S' : 'H';
                if (handTotal === 12) return (dealerValue >= 4 && dealerValue <= 6) ? 'S' : 'H';
                if (handTotal === 11 && hand.cards.length === 2) return 'D';
                if (handTotal === 10 && hand.cards.length === 2) return dealerValue <= 9 ? 'D' : 'H';
                if (handTotal === 9 && hand.cards.length === 2) return (dealerValue >= 3 && dealerValue <= 6) ? 'D' : 'H';
                return 'H';
            },
            
            showFeedback(msg, correct) {
                const el = document.getElementById('strategy-feedback');
                el.textContent = msg;
                el.className = 'strategy-feedback ' + (correct ? 'correct' : 'incorrect') + ' show';
                setTimeout(() => el.classList.remove('show'), 2000);
            },
            
            hideFeedback() {
                document.getElementById('strategy-feedback').classList.remove('show');
            },
            
            saveStreak() {
                const scores = JSON.parse(localStorage.getItem('bjScores') || '[]');
                if (!scores.length || this.perfectStreak > (scores[0].streak || 0)) {
                    scores.unshift({streak: this.perfectStreak, date: new Date().toISOString()});
                    localStorage.setItem('bjScores', JSON.stringify(scores.slice(0, 10)));
                }
            },
            
            getLeaderboard() {
                return JSON.parse(localStorage.getItem('bjScores') || '[]');
            },
            
            enableActions(enabled) {
                document.querySelectorAll('#bj-actions .bj-btn').forEach(btn => {
                    btn.disabled = !enabled;
                });
                
                if (enabled && this.hands[this.currentHand]) {
                    const hand = this.hands[this.currentHand];
                    document.querySelectorAll('#bj-actions .bj-btn').forEach(btn => {
                        if (btn.textContent === 'DOUBLE') btn.disabled = hand.cards.length !== 2;
                        if (btn.textContent === 'SPLIT') btn.disabled = hand.cards.length !== 2 || hand.cards[0].rank !== hand.cards[1].rank;
                        if (btn.textContent === 'SURRENDER') btn.disabled = hand.cards.length !== 2;
                    });
                }
            },
            
            render() {
                // Dealer
                const dealerEl = document.getElementById('dealer-cards');
                dealerEl.innerHTML = this.dealer.cards.map(c => this.renderCard(c)).join('');
                
                // Player hands
                const handsEl = document.getElementById('player-hands');
                handsEl.innerHTML = this.hands.map((hand, i) => `
                    <div class="player-hand ${hand.active?'active':''} ${hand.busted?'busted':''} ${hand.won?'won':''} ${hand.lost?'lost':''} ${hand.push?'push':''}">
                        <div class="hand-label">
                            <span>Hand ${i+1}</span>
                            ${hand.result ? `<span class="hand-result" style="color:${hand.won?'var(--accent-gold)':hand.push?'var(--accent-blue)':'var(--accent-red)'}">${hand.result}</span>` : ''}
                        </div>
                        <div class="hand-cards">${hand.cards.map(c => this.renderCard(c)).join('')}</div>
                    </div>
                `).join('');
            },
            
            renderCard(card) {
                if (card.faceDown) {
                    return '<div class="bj-card face-down"></div>';
                }
                
                const rank = card.rank || (card.actualCard && card.actualCard.rank) || '';
                const suit = card.suit || (card.actualCard && card.actualCard.suit) || 'spades';
                const suitSymbol = this.suitSymbols[suit] || '‚ô†';
                const color = ['hearts','diamonds'].includes(suit) ? 'card-red' : 'card-black';
                
                return `
                    <div class="bj-card">
                        <div class="bj-card-rank ${color}">${rank}</div>
                        <div class="bj-card-suit ${color}">${suitSymbol}</div>
                    </div>
                `;
            },
            
            sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            },
            
            quitGame() {
                if (confirm('End session?')) {
                    app.backToHome();
                }
            }
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => app.init());
        
        // Keyboard shortcuts
        document.addEventListener('keydown', e => {
            if (countingGame.active) {
                if (e.key === ' ') { e.preventDefault(); countingGame.nextCard(); }
                if (e.key === 'p') { e.preventDefault(); countingGame.pauseGame(); }
                if (e.key === 'Escape') countingGame.quitGame();
            }
        });
        
        // PWA Service Worker Registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('data:text/javascript;base64,Y29uc3QgQ0FDSEVfTkFNRSA9ICdjYXJkLWNvdW50ZXItcHJvLXYxJzsKY29uc3QgdXJsc1RvQ2FjaGUgPSBbJy4vJ107CnNlbGYuYWRkRXZlbnRMaXN0ZW5lcignaW5zdGFsbCcsIGV2ZW50ID0+IHsKICBldmVudC53YWl0VW50aWwoY2FjaGVzLm9wZW4oQ0FDSEVfTkFNRSkudGhlbihjYWNoZSA9PiBjYWNoZS5hZGRBbGwodXJsc1RvQ2FjaGUpKSk7Cn0pOwpzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2ZldGNoJywgZXZlbnQgPT4gewogIGV2ZW50LnJlc3BvbmRXaXRoKGNhY2hlcy5tYXRjaChldmVudC5yZXF1ZXN0KS50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlIHx8IGZldGNoKGV2ZW50LnJlcXVlc3QpKSk7Cn0pOw==').catch(err => console.log('Service Worker registration failed:', err));
        }
    </script>
</body>
</html>